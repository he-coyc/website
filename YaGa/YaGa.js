// Name: YaGa
// ID: he_coyc
// Description: Реализация Яндекс SDK для монетизации ваших проектов.
// By: he_coyc <he-coyc.ru>

const icon = "data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1OTkuODU2MzYiIGhlaWdodD0iNTk5Ljg1NjM2IiB2aWV3Qm94PSIwLDAsNTk5Ljg1NjM2LDU5OS44NTYzNiI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTE5LjkyODE4LC0yMC4wNzE4MikiPjxnIGRhdGEtcGFwZXItZGF0YT0ieyZxdW90O2lzUGFpbnRpbmdMYXllciZxdW90Ozp0cnVlfSIgZmlsbC1ydWxlPSJub256ZXJvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS1kYXNoYXJyYXk9IiIgc3Ryb2tlLWRhc2hvZmZzZXQ9IjAiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTogbm9ybWFsIj48cGF0aCBkPSJNLTExOS45MjgxOCwzMjBjMCwtMTY1LjY0NTc2IDEzNC4yODI0MiwtMjk5LjkyODE4IDI5OS45MjgxOCwtMjk5LjkyODE4YzE2NS42NDU3NiwwIDI5OS45MjgxOCwxMzQuMjgyNDIgMjk5LjkyODE4LDI5OS45MjgxOGMwLDE2NS42NDU3NiAtMTM0LjI4MjQyLDI5OS45MjgxOCAtMjk5LjkyODE4LDI5OS45MjgxOGMtMTY1LjY0NTc2LDAgLTI5OS45MjgxOCwtMTM0LjI4MjQyIC0yOTkuOTI4MTgsLTI5OS45MjgxOHoiIGZpbGw9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMCIvPjxwYXRoIGQ9Ik01My4xMjMxMyw1MTAuNDgxMDVjLTEuNTg5MTksMCAtMy4xNDM3NiwtMC4xNDgyOCAtNC42NTA2MSwtMC40MzE3N2wtMi43OTIwNSwtMC4xMDUwN2wtMS41MzMyOCwtMS4xMjI4NmMtOC4yODIzNiwtMy4xODcxOCAtMTQuNDM5NTksLTEwLjY1NTkzIC0xNS43NjAxNywtMTkuNjk0NzNsLTAuNzY0MTQsLTEuNzU0NDFsMC41MTU1OCwtMi43NzUwNGMwLjA4ODY3LC0yLjU1MTg5IDAuNTU5ODEsLTUuMDA2NTUgMS4zNTc4NiwtNy4zMDg0N2wwLjIwMDc1LC0xLjA4MDQ3bDAuNTQ3ODMsLTAuODIxNzVjMS42NjY3NywtMy43NzIwMSA0LjIzOTAyLC03LjA1NDM0IDcuNDQxMiwtOS41NzE0Mmw3LjMyNzE3LC01Ljg2MTczbDEuNTcxODQsLTEuMDE4NzlsMS41MTk2MywtMS4wOTUxNWwyNC45NTczNCwtMTQuNDQ4OTlsNy43MDkxOSwtOC44MTA1MWw4LjkyNjAxLC0xMC40MTM2NmwxLjUwODM1LC0xLjQ0MDgxbDAuMTYwMzksLTAuMjEwMWwwLjU5ODgyLC0wLjUxNTEybDAuNTcxMTcsLTAuNTQ1NmwwLjIyNDc3LC0wLjEzOTA5bDEuNTgxMzQsLTEuMzYwM2w5LjgzOTgzLC02Ljg4Nzg4bDAuMDUwMTEsLTAuMTIwMjZsMy41NDE3MSwtMy40NDU5OWwzLjQ0NTk5LC0zLjU0MTcybDEuNzExMjgsLTAuNzEzMDNsMS4wODM4MSwtMC42ODQ1MWw2LjA1MTU4LC0zLjAyNTc4bDguMTgyNSwtNy4yNzMzM2wyLjUzNTk3LC00LjIyNjYybDEuMTUxMjYsLTEuNTQ1OThsMS4wODA1MywtMS41OTYyM2w3LjUwNzUxLC05LjAwOTAxbDAuODA5NDMsLTAuNzk0OTdsMC43MTg0MywtMC44NzgwOGwxLjkwMzQ0LC0xLjkwMzQ0bC0wLjMyMDY5LC0wLjEwNTY4bC0xLjY5MjE3LC0wLjQ0ODUzbC0yMy41OTA2OCwtOC44NDY1bC00LjA2NTQ1LC0xLjM1NTE1bC0zLjA0MzQ2LC0xLjM2NDMxbC0wLjE3NjExLC0wLjA1Njg0bC0wLjE3Njc3LC0wLjEwMTM0bC0wLjE4NTk0LC0wLjA4MzM1bC0wLjE0OTU1LC0wLjEwODk5bC0yLjg5MzQ0LC0xLjY1ODkxbC0xMC41MTA1MSwtNy41MDc1MWwtMi43MjgxNiwtMi4zOTIzOGwtMC4wODQ2NCwtMC4wNjAzMmwtMC4wNjU3NSwtMC4wNzE1NWwtMC4wNzMwNiwtMC4wNjQwN2wtMC4wNjIyNywtMC4wODMyMWwtMi40NTUxNywtMi42NzE4bC00LjUwNDUsLTYuMDA2MDFsLTEuMjE3NCwtMi4wMTMzOWwtMC4xODEwOSwtMC4yMjAwNmwtMC4yOTg0NiwtMC41NzMwNGwtMC4zMzQzMSwtMC41NTI4OWwtMC4wOTM4MiwtMC4yNjkxMWwtMS4wODY4NSwtMi4wODY3NWwtMi44ODk3OSwtNy4yMjQ0N2wtNC4wOTUwMywtOS41NTUwN2wtMy4yNzY2NywtNi41NTMzNGwtMC40MTM2MSwtMC40Nzg5MWwtMC4zMDQ3NywtMC45NTc4M2wtMC4xODA5MSwtMC4zNjE4NGwtMS4zOTc1NCwtMy42Njg1NWwtMC4yODc4OSwtMS44MzUyN2wtMC41NjMyNywtMS43NzAyN2wtMC4zOTA2MiwtMy45MDYyNXYtMC40MDQ1NGwtMC4xNTU3NywtMC45OTNsMC4xNTU3NywtMC42MTMzMnYtOC40OTk2NGwwLjI0NTEyLC0yLjQ1MTIxbDAuMjQwMzYsLTIuNDUxNjlsMS41MDE1LC03LjUwNzUxbDAuMjk2NDYsLTAuOTY4NDRsMC4xNzk5NiwtMC45OTY2OWwyLjk2MTYzLC0xMC4zNjU3MWw0LjQ2NDg4LC0xNi4zNzEyM2wwLjc1Nzk5LC0xLjk3ODE3bDAuMDU2MTQsLTAuMjYxOThsMC4zMTQzNiwtMC43MDQ5M2wwLjI3NjE3LC0wLjcyMDc0bDAuMTQ1NTYsLTAuMjI0OTVsMC44NjI4LC0xLjkzNDc2bDEwLjc0ODc2LC0xOC44MTAzNGwwLjA4MzA4LC0wLjM0MjE1bDAuNDc1NDYsLTAuNjM1MjhsMC43MDQ3MiwtMS4yMzMyNWwyLjI3NzIsLTMuMTk3NzdsMS4wNzI5LC0wLjk4Njc1bDAuODczNDIsLTEuMTY3MDJsMi45NTE2LC0yLjU4ODMybDEuMTU1ODMsLTAuODI1NTlsMC41ODQwNSwtMC41MzcxNWwwLjMzMjAzLC0wLjExNzE5bDcuNDM1MDcsLTUuMzEwNzdsMTEuMDgzODksLTkuNjk4NDFsMC43NjgxMSwtMC41NDczOWwwLjY5NDUsLTAuNjM4MTlsMTguMDE4MDEsLTEzLjUxMzUxbDIuMDEzMzksLTEuMjE3NGwwLjIyMDA2LC0wLjE4MTA4bDAuNTczMDQsLTAuMjk4NDZsMC41NTI4OSwtMC4zMzQzMWwwLjI2OTExLC0wLjA5MzgxbDIuMDg2NzUsLTEuMDg2ODZsNC4wNjc3OCwtMS42MjcxMWwyLjYwNTc0LC0yLjA4NDU5bDAuMTk0MDIsLTAuMjc1NTdsMC42NTg2NywtMC40MDY1OWwxLjE1NjIxLC0wLjkyNDk2bDMuMjk0MjksLTIuMTM1MTlsMS4zNDE3NiwtMC41MTUzMWwxLjIyMzA2LC0wLjc1NDk4bDMuNjk0ODgsLTEuMzI2MzdsMS40MzY0NSwtMC4zNTkxMWwwLjcyMjYsLTAuMjc3NTJsMC4zMzY3NywwLjAxMjY4bDcuODcwMTYsLTEuOTY3NTNsMTMuNDM5NjcsLTUuMzc1ODdsMy43NzE5NCwtMS4wODgwNmwwLjgyMTYsLTAuMDU5NjNsMC43ODQ5OCwtMC4yNDk3N2wzLjkwNjI1LC0wLjM5MDYyaDQuNTA0NTFsMy45MDYyNSwwLjM5MDYzbDEuODIxOTIsMC41Nzk3bDMuMTc3NDQsMC4wNjAzM2wyLjQ2MzUyLDEuNzM0NTJsMS4xMzA4OCwwLjM1OTgzbDIuNzM1MTUsMi4zNjIxOGwyLjk1NTAyLDIuMDgwNThsMC42MjMzNiwxLjAwOTg0bDIuMjgwMjIsMS45NjkyOGwwLjgyOTE3LDMuMDY3OTNsMS4wMDQyOCwxLjYyNjkzbDEuMzI2MzcsMy42OTQ4OGwxLjUwMTUsNi4wMDZsMC4yODE1MSwxLjkyMzU5bDAuMDc0MzEsMC4yMzM1NWwwLjA4NjYsMC44NjYwNGwwLjEyNjAyLDAuODYxMThsLTAuMDE1NDUsMC4yNDQ2bDAuMTkzNDQsMS45MzQ0M3YyMC41NjA5OWw5LjI1NjM1LDkyLjk5NTExbC0zLjM1MzUyLDQ1LjkxNzk1bDMuMTA2MTgsNTUuNzgyMDVsMi40NzA1Miw3Ni45OTUyNmMwLDAgMy4xMjcyNCwyNi4yMDIyNyA0LjA0OTQxLDQzLjA1MzMyYzAuOTIyMTcsMTYuODUxMDUgLTAuNjI3NTQsMTkuNDc1NDcgLTAuNjI3NTQsMTkuNDc1NDdsLTEyLjQ3NjE3LDguMjc2MjdsLTE0Ljk0NjcxLDAuODY0NjlsLTkuNzU4NTksLTUuODA1NzVsLTUuMzExNjQsLTcuMjg4MDZsLTEuNjA1ODQsLTMuNTgyMjdsLTMuMDAzLC05LjAwOTAxbC0wLjg2NDY4LC0zLjgyOTMybC0wLjAwMTIsLTAuMDg3MWwtMC4wMjY0MSwtMC4wODMwMmwtMC4zOTA2MiwtMy45MDYyNXYtNDUuNTcyNTZsLTIuNTE3NTIsLTEyLjU4NzZsLTAuMTE5MywtMS4yMTY4NGwtMC4yNDIxMSwtMS4xOTg0N2wtMS41MDE1MSwtMTUuMDE1MDJ2LTAuMTEzMTJsLTAuMDIxNCwtMC4xMTEwOGwtMS41MDE1LC0xNi41MTY1MmwwLjAwMTU3LC0wLjE3NDM0bC0wLjAzMDYsLTAuMTcxNjRsLTEuNTAxNTEsLTE5LjUxOTUybDAuMDIyMDEsLTAuOTYwOTZsLTAuMDk1NjUsLTAuOTU2NDR2LTYuNzY5OTVsLTAuNzQ1MjksMS4xMTc5M2wtMS41NjM2NSwxLjkwMzU3bC0xLjU1OTk0LDEuOTA2NmwtNi43MDU2Myw2LjcwNTYzbC01LjU0NDE2LDYuNjUyOTlsLTMuNTEwMDcsNS44NTAxMmwtMi4wOTcxNywyLjgxNjJsLTAuMDcxMDEsMC4xMTk1MWwtMC4wOTM4MywwLjEwMTg0bC0wLjA4MjcsMC4xMTEwNmwtMC4xMDQzLDAuMDkxOWwtMi4zNzkyMiwyLjU4MjMzbC0xMy41MTM1MiwxMi4wMTIwMWwtMS45MDUzNCwxLjM4MDRsLTAuMjA0MjYsMC4xOTg3M2wtMC41NDYyNywwLjM0NTAxbC0wLjUyMzIyLDAuMzc5MDdsLTAuMjYwMzgsMC4xMTU4NGwtMS45ODkyOSwxLjI1NjM5bC0zLjI5MzYxLDEuNjQ2OGwtMS4wODQ1NywxLjQyMDczbC0yLjMxMjY0LDEuOTg5MzdsLTEuMDI0NjEsMS4wNTMwN2wtMC44MTAxNiwwLjMzNzU3bC0xMS4yNTUxOCw3Ljg3ODYzbC02Ljk1MjcsOC4xMTE0N2wtMC4wOTI2NCwwLjA4ODVsLTAuMDc0MzYsMC4xMDQzM2wtMTAuNTEwNTEsMTIuMDEyMDFsLTIuODY2MjUsMi42ODI1MmwtMC4xMzI5MSwwLjA4MDM4bC0wLjEwNDQ5LDAuMTE0OTFsLTMuMTg0ODUsMi4yOTUyM2wtMjYuOTAzNCwxNS41NzU2NWwtNS44ODU2NSw0LjcwODUzYy0zLjExMjUsMi41MzQgLTYuODQ2NTQsNC4zMzM4NCAtMTAuOTM4MTcsNS4xMzU1NmwtMC45MzAzNywwLjM1NzMybC0xLjEyOTEsLTAuMDQyNDljLTAuOTExMjIsMC4xMDA2NCAtMS44MzcxOSwwLjE1MjMgLTIuNzc1MjQsMC4xNTIzek0xODQuMjc5MjgsMjQyLjY5Nzg0bC0zLjkyODYsLTI0Ljg4MTExbC0wLjQ5OTA3LDAuMzk5MjZsLTIuNjg0ODIsMS43NDAxNmwtMC4xNjYsMC4xMzY2bC0wLjIyNzg3LDAuMTE4NjhsLTAuMjE1NiwwLjEzOTc0bC0wLjIwMDY4LDAuMDc3MDhsLTIuODM3NjQsMS40Nzc5NGwtNC40Mzc0OSwxLjc3NDk5bC0xNC42MTkxNiwxMC45NjQzN2wtMTEuMzAzMDQsOS44OTAxNmwtMS4wMDQzOCwwLjcxNTc2bC0wLjkyNzI4LDAuODEzMTZsLTYuMDUzMSw0LjMyMzY0bC03LjcxNzUsMTMuNTA1NjNsLTMuNjY4MjgsMTMuNDUwMzdsLTAuMDU0MTIsMC4xNDEyNGwtMC4wMjY4OCwwLjE0ODg1bC0yLjcyNTAzLDkuNTM3NTlsLTAuODE3NTgsNC4wODc4OXYyLjEzMzMybDEuODY1MTgsMy43MzAzN2wwLjI2MjA3LDAuNjg3OTNsMC4zNTU4NywwLjY0NDQzbDQuNTA0NSwxMC41MTA1MWwwLjA5MTk1LDAuMjkxODNsMC4xNDEzNCwwLjI3MTM4bDEuNzc1LDQuNDM3NDlsMC4xOTk0OSwwLjI2NTk5bDQuMzAzNiwzLjA3Mzk5bDAuOTM4MjIsMC4zMTI3NGwwLjQyMzYzLDAuMTg5OTFsMC40NDg3NiwwLjExODk1bDIyLjM4MTU3LDguMzkzMDlsOS4xMjIxOSwyLjAyNzE1aDcuNzY2MmwxLjQwMjU5LDAuMTQwMjZsMC4xMjI3LC0wLjAxMWwxLjE4OTIyLDAuMTQyMTlsMS4xOTE3NCwwLjExOTE3bDAuMTE3NCwwLjAzNzM2bDEuMzk5NjEsMC4xNjczNGw0LjQ4NjIzLDAuOTk2OTRsLTAuMzQzNzcsLTYuODc1MzVsMC4wMzExMSwtMC42MjUzOWwtMC4wNjIzMSwtMC42MjMwNXoiIGZpbGw9IiNmZmZmZmYiIHN0cm9rZS13aWR0aD0iMC41Ii8+PC9nPjwvZz48L3N2Zz48IS0tcm90YXRpb25DZW50ZXI6Mjk5LjkyODE4OjI5OS45MjgxOC0tPg==";

class YanexSDK {
  getInfo() {
    return {
      id: 'yandexsdk',
      name: 'Yandex SDK',
	    color1: "#ffcc00", // цвет блока
      color2: "#FFFFFF", 
      color3: "#FC3F1D", // цвет грани
	    menuIconURI: icon,
      blocks: [
      {
          opcode: 'ispageactive',
          blockType: Scratch.BlockType.BOOLEAN,
          text: 'is page  visible?'
      },
      "---",
      {
        opcode: 'requestPlayerData',
        blockType: Scratch.BlockType.COMMAND,
        text: 'Запросить доступ к данным игрока',
      },
      {
        opcode: 'showRating',
        blockType: Scratch.BlockType.COMMAND,
        text: 'Попросить оценить игру',
      },
      "---",
      {
        opcode: 'whenRewarded',
        blockType: Scratch.BlockType.EVENT,
        text: 'Когда получено вознаграждение',
		    isEdgeActivated: false,
      },
      {
        opcode: 'showRewardedAdvertisement',
        blockType: Scratch.BlockType.COMMAND,
        text: 'Показать ревардед-рекламу',
      },
      {
        opcode: 'showAdvertisement',
        blockType: Scratch.BlockType.COMMAND,
        text: 'Показать полноэкранную рекламу',
      },
      "---",
      {
        opcode: 'initializingLeaderboard',
        blockType: Scratch.BlockType.COMMAND,
        text: 'Инициализировать лидерборды',
      },
      {
        opcode: 'setNewScroreToLeaderboard',
        blockType: Scratch.BlockType.COMMAND,
        text: 'Занести новый результат [RESULT] в лидерборд [LEADERBOARD]',
        arguments: {
          RESULT: {
            type: Scratch.ArgumentType.STRING,
            defaultValue: '0'
          },
          LEADERBOARD: {
            type: Scratch.ArgumentType.STRING,
            defaultValue: 'Leaderboard'
          }
        }
      },
      ]
    };
  }

  ispageactive() {
	  return !document.hidden;
  }
  showRewardedAdvertisement() {
    showRewardAdvertisement();
  }
  showAdvertisement() {
    showFullscreenAdvertisement();
  }
  showRating() {
    ShowRateGame();
  }
  requestPlayerData(){
    requestPlayerDataAccess();
  }
  initializingLeaderboard(){
    initLeaderboard();
  }
  setNewScroreToLeaderboard(args){
    setNewScore(args.RESULT, args.LEADERBOARD);
  }
  
}

document.addEventListener('rewardReceived', function() {
  console.log("Reward event caught");
  Scratch.vm.runtime.startHats('yandexsdk_whenRewarded');
});

Scratch.extensions.register(new YanexSDK());